/*! epm - v0.1.0 - 2016-01-04 */
var LARGE_SCREEN_WIDTH=1200;!function(a){a(function(){a("#epm-frame-hamburger-btn").click(function(){a.epm.frame.sideNav.toggle()}),a("#epm-frame-header-wrapper .epm-frame-search-btn").click(function(){var b=a("#epm-frame-header-wrapper > .epm-frame-heading").html();a("#epm-frame-header-wrapper").addClass("search"),a("#epm-frame-header-wrapper > .epm-frame-heading").html("<span>搜索</span>"),a("#epm-frame-hamburger-btn").off("click").click(function(){a("#epm-frame-header-wrapper").removeClass("search"),a("#epm-frame-header-wrapper > .epm-frame-heading").html(b),a(this).off("click").click(function(){a.epm.frame.sideNav.toggle()}).children(".hamburger").removeClass("active")}).children(".hamburger").addClass("active")}),a("html").css({"overflow-y":"hidden","-ms-overflow-y":"hidden"}),a(window).width()>=LARGE_SCREEN_WIDTH?a.epm.tools.readCookie("sideNavActive")?null:a.epm.tools.createCookie("sideNavActive",!0):(a("body").removeClass("side-nav-active"),a.epm.tools.readCookie("sideNavActive")?a.epm.tools.eraseCookie("sideNavActive"):null),a("html").css({"overflow-y":"auto","-ms-overflow-y":"auto"})}),a(function(){a("[data-epm-toggle]").click(function(){var b=a(this),c=b.data("epm-toggle")?a(b.data("epm-toggle")):b.next(),d=c.data("epm-toggle-type"),e=null;switch(d){case"slide":case"fade":e=d+"Toggle";break;case"show":default:e="toggle"}c[e]("fast",function(){c.is(":visible")?b.removeClass("epm-toggle-closed").addClass("epm-toggle-open"):b.addClass("epm-toggle-closed").removeClass("epm-toggle-open")})}),a(document).mouseup(function(b){a("[data-epm-toggle-auto-close]:visible").each(function(){var c=a(this),d=c.data("epm-toggle-parent")?a(c.data("epm-toggle-parent")):c.parent(),e=c.attr("id")?a('[data-epm-toggle-target="#'+c.attr(id)+'"]'):c.prev();if(!d.find(b.target).length){var f=c.data("epm-toggle-type");switch(f){case"slide":c.slideUp("fast");break;case"fade":c.fadeOut("fast");break;case"show":default:c.hide("fast")}}e.addClass("epm-toggle-closed").removeClass("epm-toggle-open")})}),a(window).width()>=LARGE_SCREEN_WIDTH&&!a.epm.frame.sideNav.isActive()&&(a("#epm-frame-side-nav > nav > ul > li > ul").data("epm-toggle-auto-close","").attr("data-epm-toggle-auto-close","").hide(),a("#epm-frame-side-nav > nav > ul > li > a").addClass("epm-toggle-closed").removeClass("epm-toggle-open")),a(window).resize(function(){a("body").hasClass("side-nav-active")?(a.epm.frame.sideNav.toggle(),a.epm.frame.sideNav.toggle()):a.epm.frame.toolbar.adjust()})});a('<div class="mask">').click(function(){a("#epm-frame-hamburger-btn").click()}).appendTo("body");a.epm={data:{},frame:{version:"0.1.0",env:{bdt:a.bdt?a.bdt.version:void 0,jquery:a.fn.jquery,bootstrap:"3.3.6",material_icons:"2.1",font_awesome:"4.5"},sideNav:{isActive:function(){return a("body").hasClass("side-nav-active")},toggle:function(){var b=a("#epm-frame-hamburger-btn");if(a("body").hasClass("side-nav-active"))a("body").removeClass("side-nav-active"),b.children(".hamburger").removeClass("active"),a("html").css({"overflow-y":"auto","-ms-overflow-y":"auto"}),a("#epm-frame-page-container").css("margin-right",0),a("#epm-frame-header-wrapper").css("padding-right",0),a.epm.tools.readCookie("sideNavActive")?a.epm.tools.eraseCookie("sideNavActive"):null,a(window).width()<LARGE_SCREEN_WIDTH?a("#epm-frame-side-nav > nav > ul > li > ul").removeData("epm-toggle-auto-close").removeAttr("data-epm-toggle-auto-close"):(a("#epm-frame-side-nav > nav > ul > li > ul").data("epm-toggle-auto-close","").attr("data-epm-toggle-auto-close","").css("display","none"),a("#epm-frame-side-nav > nav > ul > li > a").addClass("epm-toggle-closed").removeClass("epm-toggle-open"));else{a("body").addClass("side-nav-active");var c=a(window).width();a("html").css({"overflow-y":"hidden","-ms-overflow-y":"hidden"});var d=a(window).width(),e=d-c;LARGE_SCREEN_WIDTH>d?(b.children(".hamburger").addClass("active"),a("#epm-frame-page-container").css("margin-right",e),a("#epm-frame-header-wrapper").css("padding-right",e)):a("html").css({"overflow-y":"auto","-ms-overflow-y":"auto"}),a("#epm-frame-side-nav > nav > ul > li > ul").removeData("epm-toggle-auto-close").removeAttr("data-epm-toggle-auto-close")}setTimeout(function(){a.epm.frame.toolbar.adjust()},300)},setMode:function(b){a("#epm-frame-side-nav").removeClass("phone-mode").removeClass("tablet-mode").removeClass("desktop-mode");-1===a.inArray(b,["phone","tablet","desktop"])?null:a("#epm-frame-side-nav").addClass(b+"-mode")}},toolbar:{setTool:function(b,c,d){a(b).each(function(){var b=a(this),e=a.epm.frame.util.getIcon(c);e+=d,b.next("ul").length&&(e+=' <span class="caret"></span>'),b.html(e)}),this.adjust()},adjust:function(){var b=a("#epm-frame-header-wrapper > .epm-frame-toolbar");if(b.children("ul:not(.collect)").length){var c=b.children("ul:first"),d=b.children("ul:last"),e=d.children("li").children("a"),f=0;a("#epm-frame-header-wrapper > :not(.epm-frame-toolbar):visible").each(function(){f+=a(this).outerWidth(!0)}),a("#epm-frame-header-wrapper > .epm-frame-toolbar > ul:last > li > ul > li").appendTo(c);var g=a("#epm-frame-header-wrapper").width()-f-d.width(),h=0;c.children("li").filter(function(){var b=a(this).is(":visible")?a(this).width():0;return g>h?(h+=b)>g:!0}).prependTo("#epm-frame-header-wrapper > .epm-frame-toolbar > ul:last > li > ul"),d.find("li > ul > li").length?d.show():d.hide(),c.children("li:visible").length?(e.children("span").removeClass("glyphicon-option-vertical").addClass("glyphicon-option-horizontal"),b.removeClass("pull-right")):(e.children("span").removeClass("glyphicon-option-horizontal").addClass("glyphicon-option-vertical"),b.addClass("pull-right"))}}},util:{getIcon:function(a){var b=a.split(/\s*:\s*/),c="",d="";switch(b.length>1?(c=b[0],d=b[1]):(c="gi",d=b[0]),c){case"gi":return'<span class="epm-icon glyphicon glyphicon-'+d+'"></span>';case"mi":return'<i class="epm-icon material-icons">'+d+"</i>";case"fa":return'<i class="epm-icon fa fa-'+d+'"></i>';default:return""}}},load:function(){a.epm.selectableTable('[data-epm="selectable-table"]'),a.epm.frame.toolbar.adjust()}},tools:{createCookie:function(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+d+"; path=/"},readCookie:function(a){for(var b=encodeURIComponent(a)+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},eraseCookie:function(a){this.createCookie(a,"",-1)},request:{getParams:function(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b},getParam:function(a){return this.getParams()[a]}}},selectableTable:function(b){a(b).each(function(){var b=a(this);b.find("thead th :checkbox,td :checkbox").off("click").click(function(){var c=a(this).prop("checked");b.find("tbody th :checkbox:enabled,td :checkbox:enabled").prop("checked",c).closest("tr")[c?"addClass":"removeClass"]("active");var d=b.find("tbody th :checked,td :checked");b.trigger("epm.table.select",[d,d.length]),a.epm.frame.toolbar.adjust()}),b.find(b.hasClass("entire-row")?"tbody tr":"tbody th :checkbox,td :checkbox").off("click").click(function(){var c=a(this).closest("tr"),d=c.find("th :checkbox,td :checkbox");d.is(":enabled")&&(c.toggleClass("active"),d.prop("checked",c.hasClass("active")),b.find("thead th :checkbox,td :checkbox").prop("checked",b.find("tbody th :checkbox:enabled,td :checkbox:enabled").length==b.find("tbody th :checked:enabled,td :checked:enabled").length),b.trigger("epm.table.select",[c,b.find("tbody th :checked,td :checked").length]),a.epm.frame.toolbar.adjust())})})},snackbar:function(){var b=arguments[0],c=a.isNumeric(arguments[1])?arguments[1]:3e3,d="string"==a.type(arguments[2])?arguments[2]:null,e=a.isFunction(arguments[1])?arguments[1]:a.isFunction(arguments[2])?arguments[2]:a.isFunction(arguments[3])?arguments[3]:null,f=a.isFunction(arguments[4])?arguments[4]:null,g=a('<div class="snackbar"><span>'+b+"</span></div>"),h=function(){g.animate({opacity:0},"fast","linear",function(){g.remove()})};d&&a("<a>"+d+"</a>").click(function(){f&&(f(),e=null,h())}).appendTo(g),g.appendTo("body").css({opacity:0,bottom:-g.height()}).animate({opacity:1,bottom:a(window).width()<=568?0:24},"fast","linear",function(){setTimeout(function(){e?e():null,h()},c)})},modal:function(b){var c='        <div class="modal fade" tabindex="-1" role="dialog"'+(b.title?' aria-labelledby="epmFrameModalLabel"':"")+'>          <div class="modal-dialog'+(b.size?" modal-"+b.size:"")+'" role="document">            <div class="modal-content">              <div class="modal-header">'+("undefined"==a.type(b.showCloseBotton)||b.showCloseBotton?'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>':"")+(b.title?'<h4 class="modal-title" id="epmFrameModalLabel">'+b.title+"</h4>":"")+'</div>              <div class="modal-body">'+b.body+"</div>            </div>          </div>        </div>      ",d=a(c);if(b.buttons){var e=a('<div class="modal-footer">');a.each(b.buttons,function(b,c){var f='<button type="button"             class="btn btn-'+(c.style?c.style:"default")+'"'+(c.dismiss?' data-dismiss="modal"':"")+">"+c.value+"</button>",g=a(f);c.click&&g.click(function(){c.click(d)}),g.appendTo(e)}),e.appendTo(d.find(".modal-content"))}return"undefined"==a.type(b.autoDismiss)||b.autoDismiss?null:d.modal({backdrop:"static",keyboard:!1}),d.on("show.bs.modal",function(a){b&&b.show?b.show(d):null}),d.on("hidden.bs.modal",function(a){b&&b.close?b.close(d):null,d.remove()}),d.appendTo("body").modal("show")}},String.prototype.endWith=function(a){return null==a||""==a||0==this.length||a.length>this.length?!1:this.substring(this.length-a.length)==a?!0:!1},String.prototype.startWith=function(a){return null==a||""==a||0==this.length||a.length>this.length?!1:this.substring(0,a.length)==a?!0:!1},Array.prototype.unique=function(){for(var a=[],b=0;b<this.length;b++)-1==a.indexOf(this[b])&&a.push(this[b]);return a},a(function(){a.epm.frame.load()})}(jQuery);