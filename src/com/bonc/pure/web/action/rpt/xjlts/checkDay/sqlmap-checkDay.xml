<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="cw.rpt.xjlts.checkDay">
	 <!-- 地域树 -->
    <select id="getPro" resultClass="java.util.HashMap" >
		SELECT F.level_id   "id",
		       F.level_name "text",
		       F.PARENT_ID   "parentId",
		       1             "leaf",
		       BM_LEVEL      "lv"
		  FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V F
		 WHERE level_id = #regionId#
    </select>
   <select id="BusinessHallCheck" resultClass="java.util.HashMap">
   SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       '1' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.CASH_FEE) CASH_FEE,
	       SUM(T.TRANSFER_FEE) TRANSFER_FEE,
	       SUM(T.BANKPOS_FEE) BANKPOS_FEE,
	       SUM(T.MISPOS_FEE) MISPOS_FEE,
	       SUM(T.OTHER_FEE) OTHER_FEE,
	       SUM(T.PAID_FEE) PAID_FEE,
	       SUM(T.PAID_DIFF_FEE) PAID_DIFF_FEE,
	       SUM(T.MONEY_FEE) MONEY_FEE,
	       SUM(T.MONEY_DIFF_FEE) MONEY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DEPART T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.LEVEL_ID = #areaNo# ) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME 
	 order by C.LEVEL_ID
	 </select>
	 <select id="BusinessHallCheckDrill" resultClass="java.util.HashMap">
	SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       '1' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.CASH_FEE) CASH_FEE,
	       SUM(T.TRANSFER_FEE) TRANSFER_FEE,
	       SUM(T.BANKPOS_FEE) BANKPOS_FEE,
	       SUM(T.MISPOS_FEE) MISPOS_FEE,
	       SUM(T.OTHER_FEE) OTHER_FEE,
	       SUM(T.PAID_FEE) PAID_FEE,
	       SUM(T.PAID_DIFF_FEE) PAID_DIFF_FEE,
	       SUM(T.MONEY_FEE) MONEY_FEE,
	       SUM(T.MONEY_DIFF_FEE) MONEY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE,
	       C.ORD
	  FROM HN_DM.DM_M_CW_CRMFEE_DEPART T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH, C.ORD
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.PARENT_ID = #areaNo#) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME, C.ORD
	UNION ALL
	SELECT T.DEPART_ID,
	       T.DEPART_NAME,
	       '1' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.CASH_FEE) CASH_FEE,
	       SUM(T.TRANSFER_FEE) TRANSFER_FEE,
	       SUM(T.BANKPOS_FEE) BANKPOS_FEE,
	       SUM(T.MISPOS_FEE) MISPOS_FEE,
	       SUM(T.OTHER_FEE) OTHER_FEE,
	       SUM(T.PAID_FEE) PAID_FEE,
	       SUM(T.PAID_DIFF_FEE) PAID_DIFF_FEE,
	       SUM(T.MONEY_FEE) MONEY_FEE,
	       SUM(T.MONEY_DIFF_FEE) MONEY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE,
	       999 ORD
	  FROM HN_DM.DM_M_CW_CRMFEE_DEPART T
	 WHERE T.NODE_ID = #areaNo#
	   AND T.MONTH_ID = #monthId#
	 GROUP BY T.DEPART_ID, T.DEPART_NAME
	UNION ALL
	SELECT T.STAFF_ID,
	       T.STAFF_NAME,
	       '0' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.CASH_FEE) CASH_FEE,
	       SUM(T.TRANSFER_FEE) TRANSFER_FEE,
	       SUM(T.BANKPOS_FEE) BANKPOS_FEE,
	       SUM(T.MISPOS_FEE) MISPOS_FEE,
	       SUM(T.OTHER_FEE) OTHER_FEE,
	       SUM(T.PAID_FEE) PAID_FEE,
	       SUM(T.PAID_DIFF_FEE) PAID_DIFF_FEE,
	       SUM(T.MONEY_FEE) MONEY_FEE,
	       SUM(T.MONEY_DIFF_FEE) MONEY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE,
	       999 ORD
	  FROM HN_DM.DM_M_CW_CRMFEE_DEPART T
	 WHERE T.DEPART_ID = #areaNo#
	   AND T.MONTH_ID = #monthId#
	 GROUP BY T.STAFF_ID, T.STAFF_NAME
	 ORDER BY ORD
	</select>
	<select id="EChannelCheck" resultClass="java.util.HashMap">
	SELECT T.AREA_NO DEPART_ID,
	       T.AREA_NAME DEPART_NAME,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.PAY_FEE) PAY_FEE,
	       SUM(T.PAY_DIFF_FEE) PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T
	 WHERE T.MONTH_ID = #monthId#
	   AND T.AREA_NO = #areaNo#
	GROUP BY T.AREA_NO, T.AREA_NAME
	 UNION ALL 
	SELECT T.DEPART_ID,
	       <![CDATA[ '&nbsp;&nbsp;&nbsp;&nbsp;' ]]> || T.DEPART_NAME || '(' || T.DEPART_ID || ')' DEPART_NAME,
	       T.ESS_FEE,
	       T.BSS_FEE,
	       T.CBSS_FEE,
	       T.ZZZD_FLAG,
	       T.FAVOURABLE_FEE,
	       T.RETURNS_FEE,
	       T.DISCOUNT_FEE,
	       T.RECEIVABLE_FEE,
	       T.PAY_FEE,
	       T.PAY_DIFF_FEE,
	       T.CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T
	 WHERE T.MONTH_ID = #monthId#
	   AND T.AREA_NO = #areaNo#
	</select>
	<select id="EChannelCheckDrill" resultClass="java.util.HashMap">
	SELECT T.DEPART_ID,
	       T.DEPART_NAME || '(' || T.DEPART_ID || ')' DEPART_NAME,
	       T.ESS_FEE,
	       T.BSS_FEE,
	       T.CBSS_FEE,
	       T.ZZZD_FLAG,
	       T.FAVOURABLE_FEE,
	       T.RETURNS_FEE,
	       T.DISCOUNT_FEE,
	       T.RECEIVABLE_FEE,
	       T.PAY_FEE,
	       T.PAY_DIFF_FEE,
	       T.CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T
	 WHERE T.MONTH_ID = #monthId#
	   AND T.AREA_NO = #areaNo#
	</select>
	<select id="EChannelCheckRoot" resultClass="java.util.HashMap">
	SELECT 'root' DEPART_ID,
	       '全省' DEPART_NAME,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.PAY_FEE) PAY_FEE,
	       SUM(T.PAY_DIFF_FEE) PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T
	 WHERE T.MONTH_ID = #monthId#
	 UNION ALL 
	SELECT * FROM  (
	SELECT T.AREA_NO DEPART_ID,
	       T.AREA_NAME DEPART_NAME,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.PAY_FEE) PAY_FEE,
	       SUM(T.PAY_DIFF_FEE) PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T, HN_DMCODE.DMCODE_AREA A
	 WHERE T.MONTH_ID = #monthId#
	   AND T.AREA_NO = A.AREA_NO
	GROUP BY T.AREA_NO, T.AREA_NAME, A.IDX_NO
	ORDER BY A.IDX_NO
	)
	</select>
	<select id="EChannelCheckBak" resultClass="java.util.HashMap">
	SELECT T.AREA_NO,
	       T.AREA_NAME,
	       T.DEPART_NAME,
	       T.DEPART_ID,
	       T.ESS_FEE,
	       T.BSS_FEE,
	       T.CBSS_FEE,
	       T.ZZZD_FLAG,
	       T.FAVOURABLE_FEE,
	       T.RETURNS_FEE,
	       T.DISCOUNT_FEE,
	       T.RECEIVABLE_FEE,
	       T.PAY_FEE,
	       T.PAY_DIFF_FEE,
	       T.CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_DZQD T, HN_DMCODE.DMCODE_AREA A
	 WHERE T.MONTH_ID = #monthId#
	 <isNotEqual property="areaNo" compareValue="root">
	   AND T.AREA_NO = #areaNo#
	 </isNotEqual>
	   AND T.AREA_NO = A.AREA_NO
	 ORDER BY A.IDX_NO
	</select>
<select id="SocialChannelCheck" resultClass="java.util.HashMap">
	SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       '1' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.ZZJ_MINUS_FEE) ZZJ_MINUS_FEE,
	       SUM(T.BEGIN_BALANCE_FEE) BEGIN_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_FEE) ZZJ_PAY_FEE,
	       SUM(T.END_BALANCE_FEE) END_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_DIFF_FEE) ZZJ_PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE
	  FROM HN_DM.DM_M_CW_CRMFEE_CHNL T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.LEVEL_ID = #areaNo#) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME
	</select>

	<select id="SocialChannelCheckDrill" resultClass="java.util.HashMap">
	SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       '1' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.ZZJ_MINUS_FEE) ZZJ_MINUS_FEE,
	       SUM(T.BEGIN_BALANCE_FEE) BEGIN_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_FEE) ZZJ_PAY_FEE,
	       SUM(T.END_BALANCE_FEE) END_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_DIFF_FEE) ZZJ_PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE,
	       C.ORD
	  FROM HN_DM.DM_M_CW_CRMFEE_CHNL T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH, C.ORD
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.PARENT_ID = #areaNo#) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME, C.ORD
	UNION ALL
	SELECT T.DEPART_ID,
	       T.DEPART_NAME,
	       '0' IS_PARENT,
	       SUM(T.ESS_FEE) ESS_FEE,
	       SUM(T.BSS_FEE) BSS_FEE,
	       SUM(T.CBSS_FEE) CBSS_FEE,
	       SUM(T.ZZZD_FLAG) ZZZD_FLAG,
	       SUM(T.FAVOURABLE_FEE) FAVOURABLE_FEE,
	       SUM(T.RETURNS_FEE) RETURNS_FEE,
	       SUM(T.DISCOUNT_FEE) DISCOUNT_FEE,
	       SUM(T.RECEIVABLE_FEE) RECEIVABLE_FEE,
	       SUM(T.ZZJ_MINUS_FEE) ZZJ_MINUS_FEE,
	       SUM(T.BEGIN_BALANCE_FEE) BEGIN_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_FEE) ZZJ_PAY_FEE,
	       SUM(T.END_BALANCE_FEE) END_BALANCE_FEE,
	       SUM(T.ZZJ_PAY_DIFF_FEE) ZZJ_PAY_DIFF_FEE,
	       SUM(T.CAPITAL_LIMIT_FEE) CAPITAL_LIMIT_FEE,
	       999 ORD
	  FROM HN_DM.DM_M_CW_CRMFEE_CHNL T
	 WHERE T.NODE_ID = #areaNo#
	   AND T.MONTH_ID = #monthId#
	 GROUP BY T.DEPART_ID, T.DEPART_NAME
	 ORDER BY ORD
	</select>
	<select id="CashInflow" resultClass="java.util.HashMap">
	<isEqual property="areaNo" compareValue="root">
	SELECT 'root' LEVEL_ID,
	       '全省' LEVEL_NAME,
	       '1' IS_PARENT,
		   SUM(T.KPI_01) KPI_01, SUM(T.KPI_02) KPI_02, SUM(T.KPI_03) KPI_03, SUM(T.KPI_04) KPI_04, 
		   SUM(T.KPI_05) KPI_05, SUM(T.KPI_06) KPI_06, SUM(T.KPI_07) KPI_07, SUM(T.KPI_08) KPI_08, 
		   SUM(T.KPI_09) KPI_09, SUM(T.KPI_10) KPI_10, SUM(T.KPI_11) KPI_11, SUM(T.KPI_12) KPI_12, 
		   SUM(T.KPI_13) KPI_13, SUM(T.KPI_14) KPI_14, SUM(T.KPI_15) KPI_15, SUM(T.KPI_16) KPI_16, 
		   SUM(T.KPI_17) KPI_17, SUM(T.KPI_18) KPI_18, SUM(T.KPI_19) KPI_19, SUM(T.KPI_20) KPI_20, 
		   SUM(T.KPI_21) KPI_21, SUM(T.KPI_22) KPI_22, SUM(T.KPI_23) KPI_23, SUM(T.KPI_24) KPI_24, 
		   SUM(T.KPI_25) KPI_25, SUM(T.KPI_26) KPI_26, SUM(T.KPI_27) KPI_27, SUM(T.KPI_28) KPI_28, 
		   SUM(T.KPI_29) KPI_29, SUM(T.KPI_30) KPI_30, SUM(T.KPI_31) KPI_31, SUM(T.KPI_32) KPI_32, 
		   SUM(T.KPI_33) KPI_33
	  FROM HN_DM.DM_M_CW_RPT_XJL T
	 WHERE T.MONTH_ID = #monthId#
	</isEqual>
	<isNotEqual property="areaNo" compareValue="root">
	SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       DECODE(C.LEVEL_ID, 'areaNo', '0', '1') IS_PARENT,
		   SUM(T.KPI_01) KPI_01, SUM(T.KPI_02) KPI_02, SUM(T.KPI_03) KPI_03, SUM(T.KPI_04) KPI_04, 
		   SUM(T.KPI_05) KPI_05, SUM(T.KPI_06) KPI_06, SUM(T.KPI_07) KPI_07, SUM(T.KPI_08) KPI_08, 
		   SUM(T.KPI_09) KPI_09, SUM(T.KPI_10) KPI_10, SUM(T.KPI_11) KPI_11, SUM(T.KPI_12) KPI_12, 
		   SUM(T.KPI_13) KPI_13, SUM(T.KPI_14) KPI_14, SUM(T.KPI_15) KPI_15, SUM(T.KPI_16) KPI_16, 
		   SUM(T.KPI_17) KPI_17, SUM(T.KPI_18) KPI_18, SUM(T.KPI_19) KPI_19, SUM(T.KPI_20) KPI_20, 
		   SUM(T.KPI_21) KPI_21, SUM(T.KPI_22) KPI_22, SUM(T.KPI_23) KPI_23, SUM(T.KPI_24) KPI_24, 
		   SUM(T.KPI_25) KPI_25, SUM(T.KPI_26) KPI_26, SUM(T.KPI_27) KPI_27, SUM(T.KPI_28) KPI_28, 
		   SUM(T.KPI_29) KPI_29, SUM(T.KPI_30) KPI_30, SUM(T.KPI_31) KPI_31, SUM(T.KPI_32) KPI_32, 
		   SUM(T.KPI_33) KPI_33
	  FROM HN_DM.DM_M_CW_RPT_XJL T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.LEVEL_ID = #areaNo#) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME
	</isNotEqual>
	</select>

	<select id="CashInflowDrill" resultClass="java.util.HashMap">
	SELECT C.LEVEL_ID,
	       C.LEVEL_NAME,
	       C.IS_PARENT,
		   SUM(T.KPI_01) KPI_01, SUM(T.KPI_02) KPI_02, SUM(T.KPI_03) KPI_03, SUM(T.KPI_04) KPI_04, 
		   SUM(T.KPI_05) KPI_05, SUM(T.KPI_06) KPI_06, SUM(T.KPI_07) KPI_07, SUM(T.KPI_08) KPI_08, 
		   SUM(T.KPI_09) KPI_09, SUM(T.KPI_10) KPI_10, SUM(T.KPI_11) KPI_11, SUM(T.KPI_12) KPI_12, 
		   SUM(T.KPI_13) KPI_13, SUM(T.KPI_14) KPI_14, SUM(T.KPI_15) KPI_15, SUM(T.KPI_16) KPI_16, 
		   SUM(T.KPI_17) KPI_17, SUM(T.KPI_18) KPI_18, SUM(T.KPI_19) KPI_19, SUM(T.KPI_20) KPI_20, 
		   SUM(T.KPI_21) KPI_21, SUM(T.KPI_22) KPI_22, SUM(T.KPI_23) KPI_23, SUM(T.KPI_24) KPI_24, 
		   SUM(T.KPI_25) KPI_25, SUM(T.KPI_26) KPI_26, SUM(T.KPI_27) KPI_27, SUM(T.KPI_28) KPI_28, 
		   SUM(T.KPI_29) KPI_29, SUM(T.KPI_30) KPI_30, SUM(T.KPI_31) KPI_31, SUM(T.KPI_32) KPI_32, 
		   SUM(T.KPI_33) KPI_33, C.ORD
	  FROM HN_DM.DM_M_CW_RPT_XJL T,
	       HN_DMCODE.DIM_NODE_ID_N_STATIC_V A,
	       (SELECT C.LEVEL_ID, C.LEVEL_NAME, C.PATH, C.ORD,C.IS_PARENT
	          FROM HN_DMCODE.DIM_NODE_ID_N_STATIC_V C
	         WHERE C.PARENT_ID = #areaNo#) C
	 WHERE T.MONTH_ID = #monthId#
	   AND T.NODE_ID = A.LEVEL_ID
	   AND A.PATH LIKE C.PATH || '%'
	 GROUP BY C.LEVEL_ID, C.LEVEL_NAME, C.ORD,C.IS_PARENT
	 <isEqual property="areaNo" compareValue="root">
	 UNION ALL
	SELECT 'HAB' LEVEL_ID,
	       '省本部' LEVEL_NAME,
	       '0' IS_PARENT,
		   SUM(T.KPI_01) KPI_01, SUM(T.KPI_02) KPI_02, SUM(T.KPI_03) KPI_03, SUM(T.KPI_04) KPI_04, 
		   SUM(T.KPI_05) KPI_05, SUM(T.KPI_06) KPI_06, SUM(T.KPI_07) KPI_07, SUM(T.KPI_08) KPI_08, 
		   SUM(T.KPI_09) KPI_09, SUM(T.KPI_10) KPI_10, SUM(T.KPI_11) KPI_11, SUM(T.KPI_12) KPI_12, 
		   SUM(T.KPI_13) KPI_13, SUM(T.KPI_14) KPI_14, SUM(T.KPI_15) KPI_15, SUM(T.KPI_16) KPI_16, 
		   SUM(T.KPI_17) KPI_17, SUM(T.KPI_18) KPI_18, SUM(T.KPI_19) KPI_19, SUM(T.KPI_20) KPI_20, 
		   SUM(T.KPI_21) KPI_21, SUM(T.KPI_22) KPI_22, SUM(T.KPI_23) KPI_23, SUM(T.KPI_24) KPI_24, 
		   SUM(T.KPI_25) KPI_25, SUM(T.KPI_26) KPI_26, SUM(T.KPI_27) KPI_27, SUM(T.KPI_28) KPI_28, 
		   SUM(T.KPI_29) KPI_29, SUM(T.KPI_30) KPI_30, SUM(T.KPI_31) KPI_31, SUM(T.KPI_32) KPI_32, 
		   SUM(T.KPI_33) KPI_33, 19 ORD
	  FROM HN_DM.DM_M_CW_RPT_XJL T
	 WHERE T.MONTH_ID = #monthId#
	   AND T.AREA_NO = 'HAB'
	 </isEqual>
	 ORDER BY ORD
	</select> 
</sqlMap>